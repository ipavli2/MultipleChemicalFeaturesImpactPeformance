# Segement data file by analogs 

profiles_m_analog_d100 <- profiles_d100 %>% filter(
   Image_Metadata_New_Name == "1m" | Image_Metadata_New_Name == "2m" | Image_Metadata_New_Name == "3m" | Image_Metadata_New_Name == "4m")

# Calculate PCA 

pca_m_analog_d100 <- prcomp(profiles_m_analog_d100[c(14:447)], scale.=TRUE, center=TRUE)

# Extract the values of rotated data 

pca_m_analog_d100_x <- cbind(profiles_m_analog_d100[c(1:15)], pca_m_analog_d100$x)

# Extract the precentage of correlation explained 

summary(pca_m_analog_d100)

# Plot PCA, note final graph was made through editing using PowerPoint, adding a different key, matching the font style for the axis and adding mp-values.

p.m.100 <- ggplot(pca_m_analog_d100_x, aes(x=PC1, y=PC2, color = Image_Metadata_New_Name))
                  + geom_point(size=5) 
                  + stat_ellipse(level=0.95, linetype=1) 
                  + scale_color_manual(values = c("#bd00be", "#80ffff", "#26bf79", "#000080"))

p.m.100 + theme_bw() + theme(axis.text = element_text(size=20, face="bold"), panel.border = element_rect(size=1.5))
